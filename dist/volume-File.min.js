(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory();
	else if(typeof define === 'function' && define.amd)
		define([], factory);
	else if(typeof exports === 'object')
		exports["volumeFile"] = factory();
	else
		root["volumeFile"] = factory();
})(self, function() {
return /******/ (() => { // webpackBootstrap
/******/ 	"use strict";
/******/ 	var __webpack_modules__ = ({

/***/ "./src/index.ts":
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => __WEBPACK_DEFAULT_EXPORT__
/* harmony export */ });
/* harmony import */ var _obj_Obj_File__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./obj/Obj-File */ "./src/obj/Obj-File.ts");

var volumeFile = {
    getObjFile: function (file) {
        return new _obj_Obj_File__WEBPACK_IMPORTED_MODULE_0__.default(file);
    }
};
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (volumeFile);


/***/ }),

/***/ "./src/obj/Obj-File.ts":
/*!*****************************!*\
  !*** ./src/obj/Obj-File.ts ***!
  \*****************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => __WEBPACK_DEFAULT_EXPORT__
/* harmony export */ });
/* harmony import */ var _Obj_Model__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./Obj-Model */ "./src/obj/Obj-Model.ts");
/* harmony import */ var _Obj_Parser__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./Obj-Parser */ "./src/obj/Obj-Parser.ts");
var __awaiter = (undefined && undefined.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
var __generator = (undefined && undefined.__generator) || function (thisArg, body) {
    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;
    return g = { next: verb(0), "throw": verb(1), "return": verb(2) }, typeof Symbol === "function" && (g[Symbol.iterator] = function() { return this; }), g;
    function verb(n) { return function (v) { return step([n, v]); }; }
    function step(op) {
        if (f) throw new TypeError("Generator is already executing.");
        while (_) try {
            if (f = 1, y && (t = op[0] & 2 ? y["return"] : op[0] ? y["throw"] || ((t = y["return"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;
            if (y = 0, t) op = [op[0] & 2, t.value];
            switch (op[0]) {
                case 0: case 1: t = op; break;
                case 4: _.label++; return { value: op[1], done: false };
                case 5: _.label++; y = op[1]; op = [0]; continue;
                case 7: op = _.ops.pop(); _.trys.pop(); continue;
                default:
                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }
                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }
                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }
                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }
                    if (t[2]) _.ops.pop();
                    _.trys.pop(); continue;
            }
            op = body.call(thisArg, _);
        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }
        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };
    }
};


var ObjFile = /** @class */ (function () {
    function ObjFile(file) {
        this._file = file;
        this._objModel = new _Obj_Model__WEBPACK_IMPORTED_MODULE_0__.default();
        this._objParser = new _Obj_Parser__WEBPACK_IMPORTED_MODULE_1__.OBJParser(this._objModel);
    }
    Object.defineProperty(ObjFile.prototype, "model", {
        get: function () { return this._objModel; },
        enumerable: false,
        configurable: true
    });
    ;
    ObjFile.prototype.read = function () {
        return __awaiter(this, void 0, void 0, function () {
            var gotBuffer;
            return __generator(this, function (_a) {
                switch (_a.label) {
                    case 0: return [4 /*yield*/, this.getBuffer(this._file)];
                    case 1:
                        gotBuffer = _a.sent();
                        if (gotBuffer) {
                            this._objParser.parse(this._fileReaderResult);
                        }
                        return [2 /*return*/];
                }
            });
        });
    };
    ObjFile.prototype.getBuffer = function (file) {
        return __awaiter(this, void 0, void 0, function () {
            var thisObj;
            return __generator(this, function (_a) {
                thisObj = this;
                return [2 /*return*/, new Promise(function (resolve, reject) {
                        var reader = new FileReader();
                        reader.onload = function () {
                            thisObj._fileReaderResult = reader.result;
                            resolve(true);
                        };
                        reader.onerror = function () {
                            reject(false);
                        };
                        reader.readAsArrayBuffer(file);
                    })];
            });
        });
    };
    return ObjFile;
}());
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ObjFile);


/***/ }),

/***/ "./src/obj/Obj-Model.ts":
/*!******************************!*\
  !*** ./src/obj/Obj-Model.ts ***!
  \******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => __WEBPACK_DEFAULT_EXPORT__
/* harmony export */ });
var ObjModel = /** @class */ (function () {
    function ObjModel() {
    }
    return ObjModel;
}());
/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (ObjModel);


/***/ }),

/***/ "./src/obj/Obj-Parser.ts":
/*!*******************************!*\
  !*** ./src/obj/Obj-Parser.ts ***!
  \*******************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "OBJParser": () => /* binding */ OBJParser
/* harmony export */ });
var StructureSymbols;
(function (StructureSymbols) {
    StructureSymbols["None"] = "";
    //#region Vertex data
    StructureSymbols["Comment"] = "#";
    StructureSymbols["MTLib"] = "mtlib";
    StructureSymbols["ModelName"] = "o";
    StructureSymbols["GeometricVertices"] = "v";
    StructureSymbols["TextureVertices"] = "vt";
    StructureSymbols["VerticesNormals"] = "vn";
    //#endregion
    //#region Elements
    StructureSymbols["Point"] = "p";
    StructureSymbols["Line"] = "l";
    StructureSymbols["Face"] = "f";
    StructureSymbols["Curve"] = "curv";
    //#endregion
})(StructureSymbols || (StructureSymbols = {}));
var ObjFileStructureTokens;
(function (ObjFileStructureTokens) {
    ObjFileStructureTokens[ObjFileStructureTokens["None"] = 0] = "None";
    //#region Vertex data
    ObjFileStructureTokens[ObjFileStructureTokens["Comment"] = 1] = "Comment";
    ObjFileStructureTokens[ObjFileStructureTokens["MTLib"] = 2] = "MTLib";
    ObjFileStructureTokens[ObjFileStructureTokens["ModelName"] = 3] = "ModelName";
    ObjFileStructureTokens[ObjFileStructureTokens["GeometricVertices"] = 4] = "GeometricVertices";
    ObjFileStructureTokens[ObjFileStructureTokens["TextureVertices"] = 5] = "TextureVertices";
    ObjFileStructureTokens[ObjFileStructureTokens["VertexNormals"] = 6] = "VertexNormals";
    //#endregion
    //#region Elements
    ObjFileStructureTokens[ObjFileStructureTokens["Point"] = 7] = "Point";
    ObjFileStructureTokens[ObjFileStructureTokens["Line"] = 8] = "Line";
    ObjFileStructureTokens[ObjFileStructureTokens["Face"] = 9] = "Face";
    ObjFileStructureTokens[ObjFileStructureTokens["Curve"] = 10] = "Curve";
    //#endregion
})(ObjFileStructureTokens || (ObjFileStructureTokens = {}));
var OBJParser = /** @class */ (function () {
    function OBJParser(objModel) {
        this.spaceChar = ' ';
        this.doubleSpaceChar = '  ';
        this.slashChar = '/';
        this.NEWLINE_DEC = 10;
        this.SPACE_DEC = 32;
        this._b_line_i = 0;
        this._indexer = 0;
        this._iobjModel = objModel;
        this.decoder = new TextDecoder("utf-8");
        this._iobjModel.vertices = new Array();
        this._iobjModel.verticesNormals = new Array();
        this._iobjModel.faces = new Array();
    }
    //#region Public Methods
    OBJParser.prototype.parse = function (buffer) {
        var _this = this;
        this._buffInt8Array = new Int8Array(buffer);
        //Structure token
        var structureToken;
        //Index for 'end of file' detection
        var indexer = 0;
        //One hole line
        var line;
        //First two symbols(without spaces) of line
        var tokenSymbols;
        var stringArray = [];
        var faceLineArray = [];
        var _loop_1 = function () {
            //line = this.getLine(this._buffInt8Array, indexer);
            this_1.findBufferNewLine();
            line = this_1.decoder.decode(this_1._buffInt8Array.subarray(this_1._indexer, this_1._b_line_i));
            indexer += line.length + 1;
            this_1._indexer = indexer;
            tokenSymbols = this_1.getTokenSymbols(line);
            line = line.slice(2, line.length);
            switch (tokenSymbols) {
                case StructureSymbols.GeometricVertices:
                    {
                        //Set token
                        structureToken = ObjFileStructureTokens.GeometricVertices;
                        line = this_1.deleteFirstSpaces(line);
                        if (line.includes(this_1.doubleSpaceChar)) {
                            stringArray = line.split(this_1.doubleSpaceChar, 3);
                        }
                        else {
                            stringArray = line.split(this_1.spaceChar, 3);
                        }
                        var newVertices = new Float32Array(stringArray.length);
                        for (var i = 0; i < stringArray.length; i++) {
                            newVertices[i] = parseFloat(stringArray[i]);
                        }
                        this_1._iobjModel.vertices.push(newVertices);
                    }
                    break;
                case StructureSymbols.VerticesNormals:
                    {
                        line = this_1.deleteFirstSpaces(line);
                        if (line.includes(this_1.spaceChar)) {
                            //stringArray = line.split(this.spaceChar, 3);
                            stringArray = this_1.split(line, this_1.spaceChar, 3);
                        }
                        this_1._iobjModel.verticesNormals.push(new Float32Array(stringArray));
                    }
                    break;
                case StructureSymbols.Face:
                    {
                        line = this_1.deleteFirstSpaces(line);
                        if (line.includes(this_1.doubleSpaceChar)) {
                            stringArray = line.split(this_1.doubleSpaceChar, 4);
                        }
                        else {
                            stringArray = line.split(this_1.spaceChar, 4);
                        }
                        if (stringArray[0].includes(this_1.slashChar)) {
                            stringArray.map(function (str, i) { return faceLineArray[i] = str.split(_this.slashChar, 3); });
                        }
                        else {
                            stringArray.map(function (str, i) { return faceLineArray[i] = str.split(_this.spaceChar, 3); });
                        }
                        var oneFaceArray_1 = new Array(faceLineArray.length);
                        faceLineArray.map(function (arr, i) { return oneFaceArray_1[i] = new Int32Array(arr); });
                        for (var i = 0; i < oneFaceArray_1.length; i++) {
                            for (var j = 0; j < oneFaceArray_1[i].length; j++) {
                                oneFaceArray_1[i][j]--;
                            }
                        }
                        this_1._iobjModel.faces.push(oneFaceArray_1);
                    }
                    break;
                default:
                    break;
            }
        };
        var this_1 = this;
        while (indexer <= this._buffInt8Array.byteLength) {
            _loop_1();
        }
    };
    OBJParser.prototype.getTokenSymbols = function (line) {
        var startIndex = 0;
        var i = 0;
        for (; i < line.length; i++) {
            if (line[i] === this.spaceChar) {
                if (startIndex !== -1) {
                    return line.slice(startIndex, i);
                }
                else {
                    continue;
                }
            }
        }
        return line.slice(startIndex, i);
    };
    OBJParser.prototype.getBufferTokenSymbols = function () {
        var firstSymbolIndex = -1;
        var i = this._indexer;
        for (; i < this._buffInt8Array.length; i++) {
            if (this._buffInt8Array[i] === this.SPACE_DEC) {
                if (firstSymbolIndex !== -1) {
                    return this._buffInt8Array.subarray(firstSymbolIndex, i);
                }
                else {
                    continue;
                }
            }
            else {
                firstSymbolIndex = i;
            }
        }
        if (firstSymbolIndex === -1) {
            firstSymbolIndex++;
        }
        return this._buffInt8Array.subarray(firstSymbolIndex, i);
    };
    OBJParser.prototype.findBufferNewLine = function () {
        this._b_line_i = this._indexer;
        for (; this._b_line_i < this._buffInt8Array.byteLength; this._b_line_i++) {
            if (this._buffInt8Array[this._b_line_i] === this.NEWLINE_DEC) {
                break;
            }
        }
        // if(this._b_line_i - this._indexer > this._maxLineLength)
        // {
        //     this._b_line_i = 0;
        // }
    };
    OBJParser.prototype.getLine = function (buffer, startWith, maxLineLength) {
        if (maxLineLength === void 0) { maxLineLength = 30; }
        var i = startWith;
        for (; i < buffer.byteLength; i++) {
            if (buffer[i] === 10) {
                return this.decoder.decode(buffer.subarray(startWith, i));
            }
        }
        return (i - startWith) > maxLineLength ? '' : this.decoder.decode(buffer.subarray(startWith, i));
    };
    OBJParser.prototype.deleteFirstSpaces = function (line) {
        var nSpaces = 0;
        for (var i = 0; i < line.length; i++) {
            if (line[i] === this.spaceChar) {
                nSpaces++;
            }
            else {
                //If first symbol isn't space symbol return just this line
                if (i === 0) {
                    return line;
                }
                return line.slice(nSpaces, line.length);
            }
        }
    };
    OBJParser.prototype.split = function (line, symbol, limit) {
        var retValue = new Array();
        var symbolStart = 0;
        var i = 0;
        for (; i < line.length; i++) {
            if (line[i] !== symbol) {
                symbolStart++;
                continue;
            }
            if (symbolStart > 0 && retValue.length <= limit) {
                retValue.push(line.slice(i - symbolStart, i));
                symbolStart = 0;
            }
        }
        if (symbolStart > 0) {
            retValue.push(line.slice(i - symbolStart, i));
        }
        return retValue;
    };
    return OBJParser;
}());



/***/ })

/******/ 	});
/************************************************************************/
/******/ 	// The module cache
/******/ 	var __webpack_module_cache__ = {};
/******/ 	
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/ 		// Check if module is in cache
/******/ 		if(__webpack_module_cache__[moduleId]) {
/******/ 			return __webpack_module_cache__[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = __webpack_module_cache__[moduleId] = {
/******/ 			// no module.id needed
/******/ 			// no module.loaded needed
/******/ 			exports: {}
/******/ 		};
/******/ 	
/******/ 		// Execute the module function
/******/ 		__webpack_modules__[moduleId](module, module.exports, __webpack_require__);
/******/ 	
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/ 	
/************************************************************************/
/******/ 	/* webpack/runtime/define property getters */
/******/ 	(() => {
/******/ 		// define getter functions for harmony exports
/******/ 		__webpack_require__.d = (exports, definition) => {
/******/ 			for(var key in definition) {
/******/ 				if(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {
/******/ 					Object.defineProperty(exports, key, { enumerable: true, get: definition[key] });
/******/ 				}
/******/ 			}
/******/ 		};
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/hasOwnProperty shorthand */
/******/ 	(() => {
/******/ 		__webpack_require__.o = (obj, prop) => Object.prototype.hasOwnProperty.call(obj, prop)
/******/ 	})();
/******/ 	
/******/ 	/* webpack/runtime/make namespace object */
/******/ 	(() => {
/******/ 		// define __esModule on exports
/******/ 		__webpack_require__.r = (exports) => {
/******/ 			if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 				Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 			}
/******/ 			Object.defineProperty(exports, '__esModule', { value: true });
/******/ 		};
/******/ 	})();
/******/ 	
/************************************************************************/
/******/ 	// module exports must be returned from runtime so entry inlining is disabled
/******/ 	// startup
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__("./src/index.ts");
/******/ })()
;
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly92b2x1bWVGaWxlL3dlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbiIsIndlYnBhY2s6Ly92b2x1bWVGaWxlLy4vc3JjL2luZGV4LnRzIiwid2VicGFjazovL3ZvbHVtZUZpbGUvLi9zcmMvb2JqL09iai1GaWxlLnRzIiwid2VicGFjazovL3ZvbHVtZUZpbGUvLi9zcmMvb2JqL09iai1Nb2RlbC50cyIsIndlYnBhY2s6Ly92b2x1bWVGaWxlLy4vc3JjL29iai9PYmotUGFyc2VyLnRzIiwid2VicGFjazovL3ZvbHVtZUZpbGUvd2VicGFjay9ib290c3RyYXAiLCJ3ZWJwYWNrOi8vdm9sdW1lRmlsZS93ZWJwYWNrL3J1bnRpbWUvZGVmaW5lIHByb3BlcnR5IGdldHRlcnMiLCJ3ZWJwYWNrOi8vdm9sdW1lRmlsZS93ZWJwYWNrL3J1bnRpbWUvaGFzT3duUHJvcGVydHkgc2hvcnRoYW5kIiwid2VicGFjazovL3ZvbHVtZUZpbGUvd2VicGFjay9ydW50aW1lL21ha2UgbmFtZXNwYWNlIG9iamVjdCIsIndlYnBhY2s6Ly92b2x1bWVGaWxlL3dlYnBhY2svc3RhcnR1cCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsTzs7Ozs7Ozs7Ozs7Ozs7O0FDVnFDO0FBRXJDLElBQU0sVUFBVSxHQUFHO0lBRWYsVUFBVSxFQUFFLFVBQVMsSUFBVTtRQUMzQixPQUFPLElBQUksa0RBQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUM3QixDQUFDO0NBQ0o7QUFDRCxpRUFBZSxVQUFVLEVBQUM7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FDUlE7QUFFSTtBQUV0QztJQUVJLGlCQUFZLElBQVU7UUFDZCxJQUFJLENBQUMsS0FBSyxHQUFHLElBQUksQ0FBQztRQUNsQixJQUFJLENBQUMsU0FBUyxHQUFH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SSxRQUFRLENBQUMsTUFBTSxJQUFJLEtBQUssRUFBRTtnQkFDNUMsUUFBUSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsS0FBSyxDQUFDLENBQUMsR0FBRyxXQUFXLEVBQUUsQ0FBQyxDQUFDLENBQUMsQ0FBQztnQkFFOUMsV0FBVyxHQUFHLENBQUMsQ0FBQzthQUNuQjtTQUNKO1FBRUQsSUFBRyxXQUFXLEdBQUcsQ0FBQyxFQUFFO1lBQ2hCLFFBQVEsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLEtBQUssQ0FBQyxDQUFDLEdBQUcsV0FBVyxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7U0FDakQ7UUFFRCxPQUFPLFFBQVEsQ0FBQztJQUNwQixDQUFDO0lBRVQsZ0JBQUM7QUFBRCxDQUFDOzs7Ozs7OztVQ25URDtVQUNBOztVQUVBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTtVQUNBO1VBQ0E7VUFDQTs7VUFFQTtVQUNBOztVQUVBO1VBQ0E7VUFDQTs7Ozs7V0NyQkE7V0FDQTtXQUNBO1dBQ0E7V0FDQSx3Q0FBd0MseUNBQXlDO1dBQ2pGO1dBQ0E7V0FDQSxFOzs7OztXQ1BBLHNGOzs7OztXQ0FBO1dBQ0E7V0FDQTtXQUNBLHNEQUFzRCxrQkFBa0I7V0FDeEU7V0FDQSwrQ0FBK0MsY0FBYztXQUM3RCxFOzs7O1VDTkE7VUFDQTtVQUNBO1VBQ0EiLCJmaWxlIjoidm9sdW1lLUZpbGUubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIHdlYnBhY2tVbml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uKHJvb3QsIGZhY3RvcnkpIHtcblx0aWYodHlwZW9mIGV4cG9ydHMgPT09ICdvYmplY3QnICYmIHR5cGVvZiBtb2R1bGUgPT09ICdvYmplY3QnKVxuXHRcdG1vZHVsZS5leHBvcnRzID0gZmFjdG9yeSgpO1xuXHRlbHNlIGlmKHR5cGVvZiBkZWZpbmUgPT09ICdmdW5jdGlvbicgJiYgZGVmaW5lLmFtZClcblx0XHRkZWZpbmUoW10sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1widm9sdW1lRmlsZVwiXSA9IGZhY3RvcnkoKTtcblx0ZWxzZVxuXHRcdHJvb3RbXCJ2b2x1bWVGaWxlXCJdID0gZmFjdG9yeSgpO1xufSkoc2VsZiwgZnVuY3Rpb24oKSB7XG5yZXR1cm4gIiwiaW1wb3J0IE9iakZpbGUgZnJvbSAnLi9vYmovT2JqLUZpbGUnO1xyXG5cclxuY29uc3Qgdm9sdW1lRmlsZSA9IHtcclxuXHJcbiAgICBnZXRPYmpGaWxlOiBmdW5jdGlvbihmaWxlOiBGaWxlKSB7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBPYmpGaWxlKGZpbGUpO1xyXG4gICAgfVxyXG59XHJcbmV4cG9ydCBkZWZhdWx0IHZvbHVtZUZpbGU7IiwiaW1wb3J0IE9iak1vZGVsIGZyb20gJy4vT2JqLU1vZGVsJ1xyXG5pbXBvcnQgSU9iak1vZGVsIGZyb20gJy4vSU9iai1Nb2RlbCdcclxuaW1wb3J0IHtPQkpQYXJzZXJ9IGZyb20gJy4vT2JqLVBhcnNlcidcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9iakZpbGVcclxue1xyXG4gICAgY29uc3RydWN0b3IoZmlsZTogRmlsZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9maWxlID0gZmlsZTtcclxuICAgICAgICAgICAgdGhpcy5fb2JqTW9kZWwgPSBuZXcgT2JqTW9kZWwoKTtcclxuICAgICAgICAgICAgdGhpcy5fb2JqUGFyc2VyID0gbmV3IE9CSlBhcnNlcih0aGlzLl9vYmpNb2RlbCk7XHJcbiAgICB9XHJcblxyXG4gICAgcHJpdmF0ZSBfZmlsZTogRmlsZTtcclxuXHJcbiAgICBwcml2YXRlIF9vYmpNb2RlbDpJT2JqTW9kZWw7IFxyXG4gICAgcHVibGljIGdldCBtb2RlbCgpIHsgcmV0dXJuIHRoaXMuX29iak1vZGVsIH07XHJcblxyXG4gICAgcHJpdmF0ZSBfb2JqUGFyc2VyOiBPQkpQYXJzZXI7XHJcbiAgICBwcml2YXRlIF9maWxlUmVhZGVyUmVzdWx0OiBzdHJpbmcgfCBBcnJheUJ1ZmZlcjtcclxuXHJcbiAgICBwdWJsaWMgYXN5bmMgcmVhZCgpIHtcclxuICAgICAgICBjb25zdCBnb3RCdWZmZXIgPSBhd2FpdCB0aGlzLmdldEJ1ZmZlcih0aGlzLl9maWxlKTtcclxuXHJcbiAgICAgICAgaWYoZ290QnVmZmVyKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX29ialBhcnNlci5wYXJzZSh0aGlzLl9maWxlUmVhZGVyUmVzdWx0IGFzIEFycmF5QnVmZmVyKTtcclxuICAgICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIHByaXZhdGUgYXN5bmMgZ2V0QnVmZmVyKGZpbGU6IEZpbGUpIDogUHJvbWlzZTxib29sZWFuPiB7XHJcbiAgICAgICAgY29uc3QgdGhpc09iaiA9IHRoaXM7XHJcbiAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuICAgICAgICAgICAgY29uc3QgcmVhZGVyID0gbmV3IEZpbGVSZWFkZXIoKTtcclxuXHJcbiAgICAgICAgICAgIHJlYWRlci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzT2JqLl9maWxlUmVhZGVyUmVzdWx0ID0gcmVhZGVyLnJlc3VsdDtcclxuICAgICAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7XHJcbiAgICAgICAgICAgIH1cclxuICAgIFxyXG4gICAgICAgICAgICByZWFkZXIub25lcnJvciA9IGZ1bmN0aW9uICgpIHtcclxuICAgICAgICAgICAgICAgIHJlamVjdChmYWxzZSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJlYWRlci5yZWFkQXNBcnJheUJ1ZmZlcihmaWxlKTtcclxuICAgICAgICB9KTtcclxuICAgIH1cclxuXHJcbn0iLCJpbXBvcnQgSU9iak1vZGVsIGZyb20gJy4vSU9iai1Nb2RlbCdcclxuXHJcbmV4cG9ydCBkZWZhdWx0IGNsYXNzIE9iak1vZGVsIGltcGxlbWVudHMgSU9iak1vZGVsXHJcbntcclxuICAgIHZlcnRpY2VzOiBGbG9hdDMyQXJyYXlbXTtcclxuICAgIGZhY2VzOiBJbnQzMkFycmF5W11bXTtcclxuICAgIHZlcnRpY2VzTm9ybWFsczogRmxvYXQzMkFycmF5W107XHJcbn0iLCJpbXBvcnQgSUZpbGVQYXJzZXIgZnJvbSAnLi4vSUZpbGVQYXJzZXInXHJcbmltcG9ydCBJT2JqTW9kZWwgZnJvbSAnLi9JT2JqLU1vZGVsJ1xyXG5cclxuZW51bSBTdHJ1Y3R1cmVTeW1ib2xzXHJcbntcclxuICAgIE5vbmUgPSAnJyxcclxuXHJcbiAgICAvLyNyZWdpb24gVmVydGV4IGRhdGFcclxuXHJcbiAgICBDb21tZW50ID0gXCIjXCIsXHJcbiAgICBNVExpYiA9IFwibXRsaWJcIixcclxuICAgIE1vZGVsTmFtZSA9IFwib1wiLFxyXG4gICAgR2VvbWV0cmljVmVydGljZXMgPSBcInZcIixcclxuICAgIFRleHR1cmVWZXJ0aWNlcyA9IFwidnRcIixcclxuICAgIFZlcnRpY2VzTm9ybWFscyA9IFwidm5cIixcclxuXHJcbiAgICAvLyNlbmRyZWdpb25cclxuXHJcbiAgICAvLyNyZWdpb24gRWxlbWVudHNcclxuXHJcbiAgICBQb2ludCA9IFwicFwiLFxyXG4gICAgTGluZSA9IFwibFwiLFxyXG4gICAgRmFjZSA9IFwiZlwiLFxyXG4gICAgQ3VydmUgPSBcImN1cnZcIlxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG59XHJcblxyXG5lbnVtIE9iakZpbGVTdHJ1Y3R1cmVUb2tlbnNcclxue1xyXG4gICAgTm9uZSA9IDAsXHJcblxyXG4gICAgLy8jcmVnaW9uIFZlcnRleCBkYXRhXHJcblxyXG4gICAgQ29tbWVudCxcclxuICAgIE1UTGliLFxyXG4gICAgTW9kZWxOYW1lLFxyXG4gICAgR2VvbWV0cmljVmVydGljZXMsXHJcbiAgICBUZXh0dXJlVmVydGljZXMsXHJcbiAgICBWZXJ0ZXhOb3JtYWxzLFxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG5cclxuICAgIC8vI3JlZ2lvbiBFbGVtZW50c1xyXG5cclxuICAgIFBvaW50LFxyXG4gICAgTGluZSxcclxuICAgIEZhY2UsXHJcbiAgICBDdXJ2ZVxyXG5cclxuICAgIC8vI2VuZHJlZ2lvblxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgT0JKUGFyc2VyIGltcGxlbWVudHMgSUZpbGVQYXJzZXJcclxuICAgIHtcclxuXHJcbiAgICAgICAgcmVhZG9ubHkgc3BhY2VDaGFyID0gJyAnO1xyXG4gICAgICAgIHJlYWRvbmx5IGRvdWJsZVNwYWNlQ2hhciA9ICcgICc7XHJcbiAgICAgICAgcmVhZG9ubHkgc2xhc2hDaGFyID0gJy8nO1xyXG5cclxuICAgICAgICByZWFkb25seSBORVdMSU5FX0RFQyA9IDEwO1xyXG4gICAgICAgIHJlYWRvbmx5IFNQQUNFX0RFQyA9IDMyO1xyXG5cclxuICAgICAgICBwcml2YXRlIF9idWZmSW50OEFycmF5OiBJbnQ4QXJyYXk7XHJcbiAgICAgICAgcHJpdmF0ZSBfYl9saW5lX2k6IG51bWJlciA9IDA7XHJcbiAgICAgICAgcHJpdmF0ZSBfaW5kZXhlcjogbnVtYmVyID0gMDtcclxuICAgICAgICBwcml2YXRlIF9pb2JqTW9kZWw6IElPYmpNb2RlbDtcclxuICAgICAgICBwcml2YXRlIGRlY29kZXIgOiBUZXh0RGVjb2RlcjtcclxuXHJcbiAgICAgICAgY29uc3RydWN0b3Iob2JqTW9kZWw6IElPYmpNb2RlbCkge1xyXG4gICAgICAgICAgICB0aGlzLl9pb2JqTW9kZWwgPSBvYmpNb2RlbDtcclxuICAgICAgICAgICAgdGhpcy5kZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKFwidXRmLThcIik7XHJcbiBcclxuICAgICAgICAgICAgdGhpcy5faW9iak1vZGVsLnZlcnRpY2VzID0gbmV3IEFycmF5PEZsb2F0MzJBcnJheT4oKTtcclxuICAgICAgICAgICAgdGhpcy5faW9iak1vZGVsLnZlcnRpY2VzTm9ybWFscyA9IG5ldyBBcnJheTxGbG9hdDMyQXJyYXk+KCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2lvYmpNb2RlbC5mYWNlcyA9IG5ldyBBcnJheTxBcnJheTxJbnQzMkFycmF5Pj4oKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vI3JlZ2lvbiBQdWJsaWMgTWV0aG9kc1xyXG4gICAgICAgIHBhcnNlKGJ1ZmZlcjogQXJyYXlCdWZmZXIpOiB2b2lkIHtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX2J1ZmZJbnQ4QXJyYXkgPSBuZXcgSW50OEFycmF5KGJ1ZmZlcik7XHJcblxyXG4gICAgICAgICAgICAvL1N0cnVjdHVyZSB0b2tlblxyXG4gICAgICAgICAgICBsZXQgc3RydWN0dXJlVG9rZW46IE9iakZpbGVTdHJ1Y3R1cmVUb2tlbnM7XHJcblxyXG4gICAgICAgICAgICAvL0luZGV4IGZvciAnZW5kIG9mIGZpbGUnIGRldGVjdGlvblxyXG4gICAgICAgICAgICBsZXQgaW5kZXhlcjogbnVtYmVyID0gMDtcclxuXHJcbiAgICAgICAgICAgIC8vT25lIGhvbGUgbGluZVxyXG4gICAgICAgICAgICBsZXQgbGluZTogc3RyaW5nO1xyXG5cclxuICAgICAgICAgICAgLy9GaXJzdCB0d28gc3ltYm9scyh3aXRob3V0IHNwYWNlcykgb2YgbGluZVxyXG4gICAgICAgICAgICBsZXQgdG9rZW5TeW1ib2xzOiBzdHJpbmc7XHJcblxyXG4gICAgICAgICAgICBsZXQgc3RyaW5nQXJyYXkgPSBbXTtcclxuXHJcblxyXG4gICAgICAgICAgICBsZXQgZmFjZUxpbmVBcnJheTogQXJyYXk8YW55PiA9IFtdO1xyXG5cclxuICAgICAgICAgICAgd2hpbGUoaW5kZXhlciA8PSB0aGlzLl9idWZmSW50OEFycmF5LmJ5dGVMZW5ndGgpXHJcbiAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgIC8vbGluZSA9IHRoaXMuZ2V0TGluZSh0aGlzLl9idWZmSW50OEFycmF5LCBpbmRleGVyKTtcclxuICAgICAgICAgICAgICAgIHRoaXMuZmluZEJ1ZmZlck5ld0xpbmUoKTtcclxuICAgICAgICAgICAgICAgIGxpbmUgPSB0aGlzLmRlY29kZXIuZGVjb2RlKHRoaXMuX2J1ZmZJbnQ4QXJyYXkuc3ViYXJyYXkodGhpcy5faW5kZXhlciwgdGhpcy5fYl9saW5lX2kpKTtcclxuICAgICAgICAgICAgICAgIGluZGV4ZXIgKz0gbGluZS5sZW5ndGggKyAxO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5faW5kZXhlciA9IGluZGV4ZXI7XHJcbiAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgIHRva2VuU3ltYm9scyA9IHRoaXMuZ2V0VG9rZW5TeW1ib2xzKGxpbmUpO1xyXG5cclxuICAgICAgICAgICAgICAgIGxpbmUgPSBsaW5lLnNsaWNlKDIsIGxpbmUubGVuZ3RoKTtcclxuXHJcbiAgICAgICAgICAgICAgICBzd2l0Y2ggKHRva2VuU3ltYm9scykge1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgU3RydWN0dXJlU3ltYm9scy5HZW9tZXRyaWNWZXJ0aWNlczpcclxuICAgICAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9TZXQgdG9rZW5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cnVjdHVyZVRva2VuID0gT2JqRmlsZVN0cnVjdHVyZVRva2Vucy5HZW9tZXRyaWNWZXJ0aWNlcztcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBsaW5lID0gdGhpcy5kZWxldGVGaXJzdFNwYWNlcyhsaW5lKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZihsaW5lLmluY2x1ZGVzKHRoaXMuZG91YmxlU3BhY2VDaGFyKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5ID0gbGluZS5zcGxpdCh0aGlzLmRvdWJsZVNwYWNlQ2hhciwgMyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdHJpbmdBcnJheSA9IGxpbmUuc3BsaXQodGhpcy5zcGFjZUNoYXIsIDMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBuZXdWZXJ0aWNlcyA9IG5ldyBGbG9hdDMyQXJyYXkoc3RyaW5nQXJyYXkubGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc3RyaW5nQXJyYXkubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdWZXJ0aWNlc1tpXSA9IHBhcnNlRmxvYXQoc3RyaW5nQXJyYXlbaV0pO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5faW9iak1vZGVsLnZlcnRpY2VzLnB1c2gobmV3VmVydGljZXMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGNhc2UgU3RydWN0dXJlU3ltYm9scy5WZXJ0aWNlc05vcm1hbHM6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUgPSB0aGlzLmRlbGV0ZUZpcnN0U3BhY2VzKGxpbmUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmUuaW5jbHVkZXModGhpcy5zcGFjZUNoYXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLy9zdHJpbmdBcnJheSA9IGxpbmUuc3BsaXQodGhpcy5zcGFjZUNoYXIsIDMpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5ID0gdGhpcy5zcGxpdChsaW5lLCB0aGlzLnNwYWNlQ2hhciwgMyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2lvYmpNb2RlbC52ZXJ0aWNlc05vcm1hbHMucHVzaChuZXcgRmxvYXQzMkFycmF5KHN0cmluZ0FycmF5KSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgYnJlYWs7XHJcbiAgICAgICAgICAgICAgICAgICAgY2FzZSBTdHJ1Y3R1cmVTeW1ib2xzLkZhY2U6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGxpbmUgPSB0aGlzLmRlbGV0ZUZpcnN0U3BhY2VzKGxpbmUpO1xyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmKGxpbmUuaW5jbHVkZXModGhpcy5kb3VibGVTcGFjZUNoYXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXkgPSBsaW5lLnNwbGl0KHRoaXMuZG91YmxlU3BhY2VDaGFyLCA0KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5ID0gbGluZS5zcGxpdCh0aGlzLnNwYWNlQ2hhciwgNCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYoc3RyaW5nQXJyYXlbMF0uaW5jbHVkZXModGhpcy5zbGFzaENoYXIpKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RyaW5nQXJyYXkubWFwKChzdHIsIGkpID0+IGZhY2VMaW5lQXJyYXlbaV0gPSBzdHIuc3BsaXQodGhpcy5zbGFzaENoYXIsIDMpKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0cmluZ0FycmF5Lm1hcCgoc3RyLCBpKSA9PiBmYWNlTGluZUFycmF5W2ldID0gc3RyLnNwbGl0KHRoaXMuc3BhY2VDaGFyLCAzKSk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29uc3Qgb25lRmFjZUFycmF5ID0gbmV3IEFycmF5KGZhY2VMaW5lQXJyYXkubGVuZ3RoKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmYWNlTGluZUFycmF5Lm1hcCgoYXJyLCBpKSA9PiBvbmVGYWNlQXJyYXlbaV0gPSBuZXcgSW50MzJBcnJheShhcnIpKTtcclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IG9uZUZhY2VBcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgb25lRmFjZUFycmF5W2ldLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG9uZUZhY2VBcnJheVtpXVtqXS0tO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgXHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9pb2JqTW9kZWwuZmFjZXMucHVzaChvbmVGYWNlQXJyYXkpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGJyZWFrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBnZXRUb2tlblN5bWJvbHMobGluZTogc3RyaW5nKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgbGV0IHN0YXJ0SW5kZXggPSAwO1xyXG4gICAgICAgICAgICBsZXQgaSA9IDA7XHJcblxyXG4gICAgICAgICAgICBmb3IgKDsgaSA8IGxpbmUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmKGxpbmVbaV0gPT09IHRoaXMuc3BhY2VDaGFyKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYoc3RhcnRJbmRleCAhPT0gLTEpXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZS5zbGljZShzdGFydEluZGV4LCBpKTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiBsaW5lLnNsaWNlKHN0YXJ0SW5kZXgsIGkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZ2V0QnVmZmVyVG9rZW5TeW1ib2xzKClcclxuICAgICAgICB7XHJcbiAgICAgICAgICAgIGxldCBmaXJzdFN5bWJvbEluZGV4ID0gLTE7XHJcbiAgICAgICAgICAgIGxldCBpID0gdGhpcy5faW5kZXhlcjtcclxuXHJcbiAgICAgICAgICAgIGZvciAoOyBpIDwgdGhpcy5fYnVmZkludDhBcnJheS5sZW5ndGg7IGkrKykge1xyXG4gICAgICAgICAgICAgICAgaWYodGhpcy5fYnVmZkludDhBcnJheVtpXSA9PT0gdGhpcy5TUEFDRV9ERUMpIHtcclxuICAgICAgICAgICAgICAgICAgICBpZihmaXJzdFN5bWJvbEluZGV4ICE9PSAtMSlcclxuICAgICAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiB0aGlzLl9idWZmSW50OEFycmF5LnN1YmFycmF5KGZpcnN0U3ltYm9sSW5kZXgsIGkpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb250aW51ZTtcclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgZmlyc3RTeW1ib2xJbmRleCA9IGk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGlmKGZpcnN0U3ltYm9sSW5kZXggPT09IC0xKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBmaXJzdFN5bWJvbEluZGV4Kys7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9idWZmSW50OEFycmF5LnN1YmFycmF5KGZpcnN0U3ltYm9sSW5kZXgsIGkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgXHJcbiAgICAgICAgZmluZEJ1ZmZlck5ld0xpbmUoKVxyXG4gICAgICAgIHtcclxuICAgICAgICAgICAgdGhpcy5fYl9saW5lX2kgPSB0aGlzLl9pbmRleGVyO1xyXG5cclxuICAgICAgICAgICAgZm9yICg7IHRoaXMuX2JfbGluZV9pIDwgdGhpcy5fYnVmZkludDhBcnJheS5ieXRlTGVuZ3RoOyB0aGlzLl9iX2xpbmVfaSsrKVxyXG4gICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICBpZih0aGlzLl9idWZmSW50OEFycmF5W3RoaXMuX2JfbGluZV9pXSA9PT0gdGhpcy5ORVdMSU5FX0RFQylcclxuICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICBicmVhaztcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgLy8gaWYodGhpcy5fYl9saW5lX2kgLSB0aGlzLl9pbmRleGVyID4gdGhpcy5fbWF4TGluZUxlbmd0aClcclxuICAgICAgICAgICAgLy8ge1xyXG4gICAgICAgICAgICAvLyAgICAgdGhpcy5fYl9saW5lX2kgPSAwO1xyXG4gICAgICAgICAgICAvLyB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBnZXRMaW5lKGJ1ZmZlcjogSW50OEFycmF5LCBzdGFydFdpdGg6IG51bWJlciwgbWF4TGluZUxlbmd0aCA9IDMwKSB7XHJcbiAgICAgICAgICAgIGxldCBpID0gc3RhcnRXaXRoO1xyXG4gICAgICAgICAgICBmb3IgKDsgaSA8IGJ1ZmZlci5ieXRlTGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmKGJ1ZmZlcltpXSA9PT0gMTApIHtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5kZWNvZGVyLmRlY29kZShidWZmZXIuc3ViYXJyYXkoc3RhcnRXaXRoLCBpKSk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiAoaSAtIHN0YXJ0V2l0aCkgPiBtYXhMaW5lTGVuZ3RoID8gJycgOiB0aGlzLmRlY29kZXIuZGVjb2RlKGJ1ZmZlci5zdWJhcnJheShzdGFydFdpdGgsIGkpKTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGRlbGV0ZUZpcnN0U3BhY2VzKGxpbmU6IHN0cmluZykge1xyXG4gICAgICAgICAgICBsZXQgblNwYWNlcyA9IDA7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbGluZS5sZW5ndGg7IGkrKylcclxuICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgaWYobGluZVtpXSA9PT0gdGhpcy5zcGFjZUNoYXIpXHJcbiAgICAgICAgICAgICAgICB7XHJcbiAgICAgICAgICAgICAgICAgICAgblNwYWNlcysrO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAge1xyXG4gICAgICAgICAgICAgICAgICAgIC8vSWYgZmlyc3Qgc3ltYm9sIGlzbid0IHNwYWNlIHN5bWJvbCByZXR1cm4ganVzdCB0aGlzIGxpbmVcclxuICAgICAgICAgICAgICAgICAgICBpZihpID09PSAwKVxyXG4gICAgICAgICAgICAgICAgICAgIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIGxpbmU7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gbGluZS5zbGljZShuU3BhY2VzLCBsaW5lLmxlbmd0aCk7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHNwbGl0KGxpbmU6IHN0cmluZywgc3ltYm9sOiBzdHJpbmcsIGxpbWl0OiBudW1iZXIpIHtcclxuICAgICAgICAgICAgY29uc3QgcmV0VmFsdWUgPSBuZXcgQXJyYXkoKTtcclxuICAgICAgICAgICAgbGV0IHN5bWJvbFN0YXJ0ID0gMDtcclxuICAgICAgICAgICAgbGV0IGkgPSAwO1xyXG4gICAgICAgICAgICBmb3IgKDsgaSA8IGxpbmUubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGlmKGxpbmVbaV0gIT09IHN5bWJvbCkge1xyXG4gICAgICAgICAgICAgICAgICAgIHN5bWJvbFN0YXJ0Kys7XHJcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICBpZihzeW1ib2xTdGFydCA+IDAgJiYgcmV0VmFsdWUubGVuZ3RoIDw9IGxpbWl0KSB7XHJcbiAgICAgICAgICAgICAgICAgICAgcmV0VmFsdWUucHVzaChsaW5lLnNsaWNlKGkgLSBzeW1ib2xTdGFydCwgaSkpO1xyXG4gICAgICAgICAgICAgICAgICAgIFxyXG4gICAgICAgICAgICAgICAgICAgIHN5bWJvbFN0YXJ0ID0gMDtcclxuICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgaWYoc3ltYm9sU3RhcnQgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICByZXRWYWx1ZS5wdXNoKGxpbmUuc2xpY2UoaSAtIHN5bWJvbFN0YXJ0LCBpKSk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIHJldHVybiByZXRWYWx1ZTtcclxuICAgICAgICB9XHJcblxyXG59IFxyXG4iLCIvLyBUaGUgbW9kdWxlIGNhY2hlXG52YXIgX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fID0ge307XG5cbi8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG5mdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cdC8vIENoZWNrIGlmIG1vZHVsZSBpcyBpbiBjYWNoZVxuXHRpZihfX3dlYnBhY2tfbW9kdWxlX2NhY2hlX19bbW9kdWxlSWRdKSB7XG5cdFx0cmV0dXJuIF9fd2VicGFja19tb2R1bGVfY2FjaGVfX1ttb2R1bGVJZF0uZXhwb3J0cztcblx0fVxuXHQvLyBDcmVhdGUgYSBuZXcgbW9kdWxlIChhbmQgcHV0IGl0IGludG8gdGhlIGNhY2hlKVxuXHR2YXIgbW9kdWxlID0gX193ZWJwYWNrX21vZHVsZV9jYWNoZV9fW21vZHVsZUlkXSA9IHtcblx0XHQvLyBubyBtb2R1bGUuaWQgbmVlZGVkXG5cdFx0Ly8gbm8gbW9kdWxlLmxvYWRlZCBuZWVkZWRcblx0XHRleHBvcnRzOiB7fVxuXHR9O1xuXG5cdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuXHRfX3dlYnBhY2tfbW9kdWxlc19fW21vZHVsZUlkXShtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuXHQvLyBSZXR1cm4gdGhlIGV4cG9ydHMgb2YgdGhlIG1vZHVsZVxuXHRyZXR1cm4gbW9kdWxlLmV4cG9ydHM7XG59XG5cbiIsIi8vIGRlZmluZSBnZXR0ZXIgZnVuY3Rpb25zIGZvciBoYXJtb255IGV4cG9ydHNcbl9fd2VicGFja19yZXF1aXJlX18uZCA9IChleHBvcnRzLCBkZWZpbml0aW9uKSA9PiB7XG5cdGZvcih2YXIga2V5IGluIGRlZmluaXRpb24pIHtcblx0XHRpZihfX3dlYnBhY2tfcmVxdWlyZV9fLm8oZGVmaW5pdGlvbiwga2V5KSAmJiAhX193ZWJwYWNrX3JlcXVpcmVfXy5vKGV4cG9ydHMsIGtleSkpIHtcblx0XHRcdE9iamVjdC5kZWZpbmVQcm9wZXJ0eShleHBvcnRzLCBrZXksIHsgZW51bWVyYWJsZTogdHJ1ZSwgZ2V0OiBkZWZpbml0aW9uW2tleV0gfSk7XG5cdFx0fVxuXHR9XG59OyIsIl9fd2VicGFja19yZXF1aXJlX18ubyA9IChvYmosIHByb3ApID0+IE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3ApIiwiLy8gZGVmaW5lIF9fZXNNb2R1bGUgb24gZXhwb3J0c1xuX193ZWJwYWNrX3JlcXVpcmVfXy5yID0gKGV4cG9ydHMpID0+IHtcblx0aWYodHlwZW9mIFN5bWJvbCAhPT0gJ3VuZGVmaW5lZCcgJiYgU3ltYm9sLnRvU3RyaW5nVGFnKSB7XG5cdFx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsIFN5bWJvbC50b1N0cmluZ1RhZywgeyB2YWx1ZTogJ01vZHVsZScgfSk7XG5cdH1cblx0T2JqZWN0LmRlZmluZVByb3BlcnR5KGV4cG9ydHMsICdfX2VzTW9kdWxlJywgeyB2YWx1ZTogdHJ1ZSB9KTtcbn07IiwiLy8gbW9kdWxlIGV4cG9ydHMgbXVzdCBiZSByZXR1cm5lZCBmcm9tIHJ1bnRpbWUgc28gZW50cnkgaW5saW5pbmcgaXMgZGlzYWJsZWRcbi8vIHN0YXJ0dXBcbi8vIExvYWQgZW50cnkgbW9kdWxlIGFuZCByZXR1cm4gZXhwb3J0c1xucmV0dXJuIF9fd2VicGFja19yZXF1aXJlX18oXCIuL3NyYy9pbmRleC50c1wiKTtcbiJdLCJzb3VyY2VSb290IjoiIn0=